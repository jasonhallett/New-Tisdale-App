async function fetchBuses(){const r=await fetch('/api/buses');const d=await r.json();renderGrid(d);}function renderGrid(d){const t=document.querySelector('#grid tbody');t.innerHTML='';for(const r of d){const e=document.createElement('tr');e.dataset.id=r.id;e.innerHTML=`<td contenteditable="false">${r.unit_number}</td><td><button class="btn-small editBtn">Edit</button></td>`;t.appendChild(e);}}document.getElementById('addBtn').addEventListener('click',()=>{const t=document.querySelector('#grid tbody');const r=document.createElement('tr');r.innerHTML=`<td contenteditable="true"></td><td><button class="btn-small saveBtn">Save</button></td>`;t.appendChild(r);});document.querySelector('#grid').addEventListener('click',async e=>{const b=e.target.closest('button');if(!b)return;const r=b.closest('tr');const id=r.dataset.id;if(b.classList.contains('editBtn')){r.children[0].setAttribute('contenteditable','true');b.textContent='Save';b.classList.replace('editBtn','saveEditBtn');}else if(b.classList.contains('saveEditBtn')){const u=r.children[0].textContent.trim();await fetch('/api/buses',{method:'PUT',headers:{'Content-Type':'application/json'},body:JSON.stringify({id,unit_number:u})});fetchBuses();}else if(b.classList.contains('saveBtn')){const u=r.children[0].textContent.trim();await fetch('/api/buses',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({unit_number:u})});fetchBuses();}});document.addEventListener('DOMContentLoaded',fetchBuses);